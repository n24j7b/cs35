java c
Applied   Mathematical   Finance
Closed Formula for Options with Discrete   Dividends and Its   Derivatives
CARLOS VEIGA  UWE WYSTUP
Frankfurt School of Finance  Management,   Centre   for Practical Quantitative Finance, Sonnemannstraße   9-11, 60314 Frankfurt   am   Main,   Germany
(Received   23 May   2008; in   revised   form   4   March   2009)ABSTRACT                      We present    a   closed pricing formula for   European   options   under   the   Black–Scholes   model   as well as   formulas   for its   partial derivatives.   The   formulas are developed   making use of   Taylor   series    expansions    and   a   proposition    that    relates    expectations    of   partial    derivatives    with   partial   derivatives   themselves.   The closed   formulas are attained assuming   the dividends are   paid in any   state   of   the world.   The results are readily extensible   to   time-dependent   volatility models. For completeness,   wereproducethenumericalresultsin   VellekoopandNieuwenhuis,coveringcallsandputs, togetherwith   results on their   partial   derivatives. The closedformulas   presented   here allow a   fast calculation of   prices   or implied volatilities when compared with other valuation   procedures that rely on numerical   methods.
KEY   WORDS:    Equity option, discrete dividend, hedging, analytic formula, closed formula
1.            Introduction
1.1          MotivationThe   motivation   to   return   to   this   issue   is the   fact   that   whenever a   new   product,   model or   valuation   procedure   is   developed,   the   problem   that   arises   with   discrete   dividends   is   dismissed   or   overlooked   by   applying   the   usual   approximation   that   transforms   the   discrete dividend into a continuous stream   of dividend payments   proportional   to   the   stock   price.   After   all   that   has   been   said   about   the   way   to   handle   discrete   dividends,   there are still strong reasons   to   justify   such   an   approach.We   here   recall   the   reasons   that   underlie   the   use   of this   method   by   the   majority   of   market participants and pricing tools currently available.   We   choose   the   word method   instead of   modelalthough   one   could   look   for   what   model   would   justify   such   calculations   and   find   the   Escrowed   Model,   as   it   is   known   in   the   literature.   We   do   not   follow   this   reasoning because we consider that such a model would be unacceptable since it admits   arbitrage. The reason being that such a model would imply two different diffusion price processes   for   the   same   underlying   stock   under   the   same   measure   if two   options   were   considered with different maturities and spanning over   a   different number   of dividend   payments.   We   thus   refuse   the   model   interpretation   and   consider   the   procedure   that   replaces   the   discrete   dividend   into   a   continuous   stream   of   dividend   payments   as   an   approximation   to   the   price of   an option,   under a   model   that   remains arbitrage   free   when   several options coexist. The models in Section   1.2 belong to that class.The   drivers   behind   the   huge   popularity   of this   method   are   mostly   due   to   the   (i)   tractability   of   the   valuation   formulas,   (ii)   applicability   to   any   given   model   for   the   underlying stock, and (iii) the preserved   continuity   of the   option price   when   crossing   each dividend date.However, the method has some significant drawbacks. First and foremost, no proof   has      ever      been      present    that      this      method      would      yield    the    correct      result      under    an   acceptable    model    in    the    sense    above.    In    fact,    for    the    natural    extensions    to    the   Black–Scholes      (BS)   model   described   in      Section    1.2,   the   error   grows   larger   as   the   dividend   date   is   farther   away   from   the   valuation   date.   This   is   exactly   the   opposite   behaviour of   what one would expect from an approximation – a larger period of   time   between   the   valuation   date   and   the   dividend   date   implies   that   the   option   valuation   functions are smoother and thus easier to   approximate.   The   other   side   of   the   inaccu-   rate pricing coin is the fact that this method does not   provide   a   hedging   strategy   that   will      guarantee      the      replication    of   the    option      payoff   at      maturity.    To    sum      up,      no   numerical   procedure   based   on   this   method   returns   (or   converges   to)   the   true   value   of the   option, in   any   of the   acceptable models we   are   aware   of.   It   still   seems   like the   advantages outweigh the drawbacks since it is   the most   widely   used   method.An   example   may   help   to   demonstrate   this.   Consider   a   stochastic   volatility   model   with   jumps. Now consider the valuation problem   of an American   style   option under   this model.   The   complexity   of this   task   is   such   that   a   rigorous   treatment   of discrete   dividends,   i.e.   a   modification   of the   underlying’s   diffusion   to   account   for   that   fact,   would render the model intractable.
1.2          Description of   the ProblemIn the presence of   discrete dividend payments, diffusion models like the BS model are   no   longer an acceptable description of   the stock   price dynamics.   The risks that   occur   in   this      context      are      mainly      the      potential      losses      arising      from      incorrect      valuation      and   ineffective hedging strategy. We address both of   these   issues   in   this   article.
The   most   natural extension to a diffusion   model to allow for   the   existence of   discrete   dividends is to consider the same   diffusion,   for   exampledSt      = St   (rdt   + σdWt   ),                                                                                                                               (1)
and add a negative   jump with the same size as the dividend, on the   dividend-payment   date as StD                = StD-       -   D. This gives rise to   the   new model   diffusiondSt      = St   (rdt   + σdWt   ) -   DⅡ{t≥tD   }   ,                                                                                                    (2)where S is the stock price, r   is   the   constant   interest   rate,   σ is   the   volatility   and    Wis a   standard   Brownian   motion.   StD-       refers   to   the   time   immediately   before   the   dividend-   payment moment, tD, and StD         to the moment   immediately   after.There are though some common objections to this formulation.   A   first   caveat   may   be the assumption that the stock price will fall by the amount of   the dividend size.   This   objection   is   mainly   driven   by   the effects taxes   have on   the   behaviour of   financial agents   and   thus   market   prices.   We   will   not   consider   this   objection   in   this   article   and   thus   assume Model (2) to be valid. A   second   objection   may   be   that   the   dividend-payment   date and amount are   not   precisely   known   until a   few   months before their payment.   We   also   believe      this      to   be      the   case,   but      a   more      realistic   model   in   this   respect   would   significantly   grow in   complexity.   Our   goal is rather   to   devise   a   simple variation   that   can be   applied   to   a wide class   of models   that   does not   worsen   the   tractability   of the   model and produces accurate results.Finally,   the model   admits negative prices   for   the   stock price   S.   This   is   in   fact   true   and can easily be seen if   one takes the stock price StD-    to be smaller thanD at time tD-   . A   simple solution to this problem is to add an extra condition in Equation (2) where the   dividend   is   paid   only   if   StD-       >   D,   i.e.dSt      = St   (rdt   + σdWt   ) -   DⅡ{t≥tD   }Ⅱ{StD- >D}   .                                                                               (3)However, in most practical applications,   this is   of no   great   importance   as   the   vast   majority   of the   companies   that   pay   dividends   have   dividend   amounts   that   equal   a   small   fraction   of   the   stock   price,   i.e.   less   than      10%   of it,   rendering   the   probability   assigned   to   negative   prices   very   small.   For   this   reason   we   may   drop   this   condition   whenever it would add significant   complexity.In the remainder of this section we review the existing   literature   on the   subject   and   the reasons that underlie the use of   the method most popular among   practitioners.   We   then   turn   to   develop   the   formulas   in   Section   2,   and   in   Section   3   we   reproduce   the   numerical results in Vellekoop   and Nieuwenhuis   (2006) together   with   put   prices   and   partial derivatives. Section 4   concludes.
1.3          Literature   ReviewHere   we   shortly   review   the   literature   on modifications   of stock   price   models   coping      with   discrete   dividend   payments.   Merton   (1973)   analysed   the   effect   of discrete   divi-      dends      in   American      calls      and      states      that      the      only      reason      for      early      exercise      is      the      existence of unprotected dividends.   Roll (1977), Geske   (1979)   and   Barone-Adesi   and      Whaley    (1986)    worked    on      the      problem      of    finding      analytic      approximations      for      American   options.   John   Hull   (1989)   in   the   first   edition   of his   book   establishes what      was to be the most used method to cope   with discrete   dividends.   The   method   works   by      subtracting from the current asset   price the   net   present value of   all dividends occurring      during the   life of   the option. On   the other end of   the spectrum,   Musiela   and   Rutkowski      (1997)   propose   a model   that   adds   the   future   value   at   maturity   of all   dividends   paid      during the lifetime of   the option to the strike price. To balance these two last methods,      Bos and Vandermark (2002) devise a method   that   divides   the   dividends   in   ‘near’   and      ‘far’    and    subtracts    the    ‘near’    dividends    from    the    stock    price    and    adds    the      ‘far’   dividends    to    the    strike    price.    A    method      that    considers      a    continuous      geometric      Brownian motion with jumps   at   the   dividend-payment   dates is   analysed in   detail   by      Wilmott   (1998)   by means   of numerical methods.   Berger   and   Klein   (1998)   propose   a   non-recombining   binomial   tree   method   to   evaluate options   under   the   jump   model. Bos   et      al.      (2003)      devise      a   method      that      adjusts      the   volatility      parameter      to   correct      the   subtraction method stated above. Haug et al. (2003)   review   existing methods’ perfor-   mance and pay special attention to the problem of   negative prices that arise within the   context of   the   jump model and propose a numerical quadrature sche代 写Applied Mathematical FinanceSQL
代做程序编程语言me. Bjrk (1998)   has   one   of the   clearest   descriptions   of the   discrete   dividends   problem   for   European   options and provides a formula for proportional   dividends.   Shreve   (2004)   also   states   the result for proportional dividends. Vellekoop and Nieuwenhuis (2006)   described   a   modification to the binomial tree method to account for discrete dividends preserving   the crucial recombining property.
2.          Closed FormulaThe   derivation   of   the   closed   formula   assumes   a   BS   model   as   in   Equation   (1)   with   constant interest rate rand constant volatility σ   . However, the following can be easily   modified to allow for time-dependent   volatility. Furthermore, our arguments consider   and are only valid for European-style   options.We assume aproblem with n dividends Di, with i = 1, . . ., n, having theirrespective   payment   dates on ti ordered   in   this   manner t0   < t1   < ... < tn   < T   and   having t0 and T   as   the valuation date and the option’s maturity date, respectively.We take a vanilla call option as   our working   example.   We   start   by   focusing   on   the   time point   just after the last dividend payment, which we will refer to astn. We choose   this point in time because it is the earliest moment on which we can make a conjecture   with respect to the price   of the   option, i.e.   from   this point   on,   we   know   how   to   price   and hedge a claim, for there are no dividends   left   until   the option   matures.   The   price   of   our call would thus be a function C(Stn,   tn   )1   of   the stock price and time, the celebrated   BS formula that we state here for   completeness   sake:As usual,K   and T   are the strike price and the   maturity date, respectively. As it is going   to   be   used   extensively   throughout   this   article,   we   take   here   the   opportunity   to   also   present the general   formula   for   the ith derivative   with   respect to   the   first   variable, St, of   Formula (4) developed by   Carr   (2001)where    N/   (x)    denotes the probability density function of the standard normal   distribution,      S1   (i;j)   the Stirling   number of   the first kind and Hi (d)   are Hermite   polynomials.The problem we face now is how to move one step back in time   to t < tn. For that we   take   Assumption   (2) in   Section   1.2. This   assumption   yields   C(Stn; tn   ) = C(Stn-         -   Dn; tn   ),   and its right-hand side already refers to the stock price at a time point   just before tn. We   now   wish   to   move   further   back   in   time   but   still   without   crossing   any   other   dividend   date, that is, to   tn-   1. This task is   a   straightforward   application   of option   pricing   theory   yieldinge-r(tn   -tn-1)Etn(Q)-   1    [   C   (Stn-         -   Dn;   tn   )];                                                                                                                  (6)
which is the discounted expectation of   the random variable   C(Stn-       -   Dn;   tn   ) under the   risk-neutral measure   Q with respect to the σ-algebra Ftn-   1   .Unfortunately,   Expression   (6)   is   not   directly   solvable   into   a   closed   formula   for   it   includes the random variable log   {Stn-         -   Dn },    which has no known or explicit   distributiona.At   this   point   our   hope   is   to   replace   the   formula   C(Stn-         -   Dn;   tn   )   by   an   equivalent   representation   that   would   not   involve    log   {Stn-         -   Dn }.   The   natural   candidate   is   the   Taylor   series   expansion   of   C   taken   at   the   point   Stn-       and   with    a   shift   of   size   -Dn.   Unfortunately,   we   know   from   the   works   of Estrella   (1995)   that   such   replacement   is   not valid for all values   of Stn- , and   thusThe reason for this is the fact that the Taylor   series expansion of   the BS formula for   calls is convergent only for shifts of a size   smaller   than   Stn-         and diverges   otherwise.   In   our      case,   where      Stn-       < Dn       the    Taylor    series      does      not      produce      the    same   values      as   C   (Stn-         -   Dn;   tn   ), and in turn, the expectation in (6) will also be   affected. We   acknowl-   edge, though,that the risk-neutral probability of Stn-         < Dn    is very small,   and thus   the   effect in (6) of   the divergence of   the Taylor series for the values Stn-       < Dn   will not affect   our approximation too much.Confronted   with   this   result,   we   tried   to   carry   the   derivation   forward   on   rigorous   grounds,   rewriting   Expression   (6)   by   introducing   an   indicator   function   for   the   set   A   =   {W   :   Stn-       >   Dn   },e-r(tn   -tn-1)Etn(Q)-   1    [   C   (Stn-   ;   tn   ) + (   C   (Stn-       -   Dn;   tn   )- C   (Stn- ;   tn   )) .   ⅡA].                                  (8)This approach did lead to a   closed   formula   for   the   case   of   problems with   only   one   dividend   payment (see   Veiga and   Wystup, 2007). However,the   cost of   this   rigour   was a   highly complex formula that cannot be generalized to fit multiple dividend problems.   For this reason we here take   a different   route.with ηn    high enough to   approximate   C(Stn-       -   Dn;   tn   ) reasonably well,   for   all   Stn-   . We   thus trade the error of   this approximation for the tractability that it enables. We do so   because we believe that in almost   all   realistic   scenarios   the   error   is   not   significant.   In   fact,   our   results   in   Section   3   based   on   this   assumption   do   provide   very   good   results   with scenarios even more demanding than realistic market conditions.
Hence, we rewrite Expression   (6)   as
Since   we   have   a   finite   series   as   integrand   function,   we   can   safely   interchange   the   integral with the summation, yieldingFinally, to turn Expression (11) above into an explicit formula   we use the following:
Proposition 2.1.          Let   C(St;   t) and   all   its   derivatives be   continuous   functions   in   its   first variable, then
Proof.            We prove the proposition by mathematical induction. For i   = 0 we getC(St;   t) = e-r(tk   -t)Et(Q)   [C(Stk;   tk   )];                                                                                                            (13)
which is true, for it states that the   discounted   BS   price   is   a martingale under   the   risk-   neutral measure   Q.
Now we need   to   check   that   the proposition   for   i implies   the   same   proposition   for   i   +   1. Changing variables by Pt    = Ste-iσ2 (tk -t)   we getEt(Q)   [∂1(i)   C(Stk;   tk   )] = e-(
where now Stk       = Pt   exp   {(r -   2   )   (tk    - t)+   σ(Wtk       - Wt   )   }.We differentiate   the   left-hand side   with   respect toPt, and since ∂1(n)C   is   continuous for
all n   ∈ N, we apply Leibniz   integral   rule,   getting
R
Taking   z   = y + σ√-k(--------)-t(--)   leaves   us   with
which equals
with Stk       = Pt   exp   , a   Brownian   motion.
Taking the derivative of   the right-hand side of (14)   with respect   to Pt, we   obtain
Equating   the   derivatives   of both   sides   of (14) with   respect   to Pt, i.e.   (17)   and   (18),   rearranging and using the fact Pt    = eσ2 (tk -t)Ste-(i+1)σ2 (tk -t), we get
which is exactly the claim for i +   1 with a positive factor   multiplying the first argument   of C on both sides   of   the equation.
We can now write Equation (19) considering a new initial stock price t(I)   = eσ2 (tk   -t)St
and rely on the geometric nature of   the diffusion St   to have also St(I)k       = eσ      (tk -t)Stk   , then
yieldingHence,   to   get   a   closed   formula   for   a   call   option   maturing   at   T with   one   discrete   dividend   payment at   time tn   of   amount   Dn,   we   explicitly rewrite Expression (11) and   we   denominate as   Cn (Stn-   1;   tn-   1   ),
In   what   follows,   we   will   require   a   more   condensed   notation,   so   we   introduce   the   abbreviations below and suppress the time variable from   all   C functions.gjtn         = exp   {-jσ2   (tn      - tn-   1   )}                                                                                                                                    (23)
Now, Formula   (21) becomesWe      can      now      resume    our      movement    backwards    in    the    time    axis    using    the    same   programme   that   led   us   here,   namely,   apply   (2)   to   move   over   the   dividend   date   tn-   1;   apply Approximation (9) now for   Cn   yielding2   
take   the   discounted   expectation   under   the   measure   Q   with   respect   to   the   σ-algebra   Ftn-2       and apply Proposition 2.1 to solve the   expectation   and   get   
Running   this   programme   for   all   n   dividends   returns   the   formula   for   an   arbitrary   number of   dividend payments
with   Il      = Σm(n)=l   im      and   GI      = Πh(n)=   1   gt(I)h(h)   .
Before   we   conclude   this   section,   we   remark   that   even   though   we   developed   our   analysis focused on a European call, it remains   valid for   other   types   of   options.   In   fact,   the above analysis is   valid for all   options that satisfy all conditions it involved,   namely,   European-style   options   that   are   priced   by   only   taking   expectations   under   the   risk-


neutral measure, Approximation (9); ∂1(n)C is continuous for all n   ∈ N to apply Leibnizintegral rule. The existence of   a   closed formula   for an arbitrary   derivative of   the   option   price,      e.g.      Formula      (5),      greatly      accelerates      the      calculation      process.      However,      the   analysis   remains   valid   if the   derivatives   are   replaced   by   numerical   approximations.   This   alternative may be useful for   problems   solved   by   finite   difference   methods   that   return a vector of   option prices for different stock prices, thus enabling the calculation   of   numerical derivatives for all the necessary   stock price levels.Therefore,   a   European   put   is   an   example   of   another   option   type   covered   in   this   analysis and for which a closed formula for an arbitrary derivative is also available   in   Carr (2001). In Section 3 we also consider European puts and observe that their prices   are coherent with the respective   call prices.
2.1            The   GreeksA      closed      formula      for      the      derivative3         of   the    option      price    of   arbitrary    order    is    a   straightforward   application   of the chain rule. Thus, for   the   dth   derivative   of the   call   price with one discrete dividend payment   we   have   The   derivatives   with   respect   to   other   variables,   namely   σ   and   r,   require   similar   derivations   that we   skip   here   since   they constitute   simple calculus   exercises.   There   is   one exception worth mentioning though: the   theta,   i.e.   the   derivative   with   respect   to   valuation time   t. The   theta can be   calculated   by   making   use   of the   BS   partial   differ-   ential equation, yielding






         
加QQ：99515681  WX：codinghelp
